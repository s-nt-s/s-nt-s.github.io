<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Reiniciar repositorio Git</title>
<link href="/theme/css/main.css" rel="stylesheet"/>
<link href="/feeds/all.atom.xml" rel="alternate" title="Apuntes Atom Feed" type="application/atom+xml"/>
</head>
<body class="home ulcompact" id="index">
<header class="body" id="banner">
<h1 class="entry-title"><a href="/reiniciar_git" rel="bookmark" title="Permalink to Reiniciar repositorio Git">Reiniciar repositorio Git</a></h1><div class="post-info">
<p>
<time class="published" datetime="2020-09-04T00:00:00+02:00" title="Publicado el 2020-09-04">2020-09-04</time>
<a class="bubble category ct_programacion" href="/category/programacion.html" title="Hay 5 entradas más sobre Programación">
Programación</a>
<a class="bubble tag tg_git" href="/tag/git.html" title="Hay 2 entradas  más sobre git">
git</a> </p>
<p>
<span class="bubble">42 lineas</span> <span class="bubble wc">268 palabras</span> <span class="bubble wc">1.628 letras</span>
</p>
</div><!-- /.post-info --> </header><!-- /#banner -->
<section class="body" id="content">
<article>
<div class="entry-content">
<p><strong>Problema</strong>: El repositorio ocupa mucho (gigas) aunque el código
representa solo un puñado de megas.</p>
<p><strong>Solución</strong>: Reiniciar el repositorio Git y olvidarse de la historia pasada.</p>
<h2>Detalle</h2>
<p>En ocasiones nuestro repositorio Git ha crecido enormemente,
cuenta con una muy larga historia de commits e incluso puede
que en ellos estén envueltos grandes ficheros que ni siquiera
usamos ya, provocando que nuestro proyecto ocupe gigas aunque
el código solo sume unos cuantos megas.</p>
<p>En una situación así puede interesar hacer borrón y cuenta nueva,
sobre todo si lo anterior lo podemos considerar un prototipo
o versión ya finalizado, listo para ser tageado y olvidarse de él.</p>
<h2>Pasos</h2>
<p><strong>1-</strong> Asegurarse de estar sincronizado y en master</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>git branch
<span class="go">* master</span>
<span class="gp">$ </span>git status
<span class="go">En la rama master</span>
<span class="go">Tu rama está actualizada con 'origin/master'.</span>

<span class="go">nada para hacer commit, el árbol de trabajo está limpio</span>
</code></pre></div>
<p><strong>2-</strong> Creamos el tag para que no se pierda nada</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>git tag -a -m <span class="s2">"Ultima versión antes de reiniciar repositorio"</span> v1
<span class="gp">$ </span>git push origin v1
</code></pre></div>
<p><strong>3-</strong> Crear una nueva rama desde 0</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>git checkout --orphan nuevo_comienzo
<span class="go">Cambiado a nueva rama 'nuevo_comienzo'</span>
<span class="gp">$ </span>git add -A
<span class="gp">$ </span>git commit -am <span class="s2">"nuevo_comienzo"</span>
<span class="gp">$ </span>git status
<span class="go">En la rama nuevo_comienzo</span>
<span class="go">nada para hacer commit, el árbol de trabajo está limpio</span>
<span class="gp">$ </span>git branch
<span class="go">  master</span>
<span class="go">* nuevo_comienzo</span>
</code></pre></div>
<p><strong>4-</strong> Sustituir master con nuevo_comienzo</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>git branch -D master <span class="c1"># Elimina 'master' original</span>
<span class="gp">$ </span>git branch -m master <span class="c1"># Renombra 'nuevo_comienzo' a 'master'</span>
<span class="gp">$ </span>git push -f origin master <span class="c1"># Sube los cambios</span>
</code></pre></div>
<p><strong>5-</strong> Limpiar todo lo que ha quedado huérfano</p>
<div class="highlight"><pre><span></span><code><span class="gp">$ </span>git gc --aggressive --prune<span class="o">=</span>all
</code></pre></div>
<p><strong>Fuentes</strong>: <a href="https://medium.com/@sangeethkumar.tvm.kpm/cleaning-up-a-git-repo-for-reducing-the-repository-size-d11fa496ba48" target="_blank">medium.com/@sangeethkumar.tvm.kpm</a>,
<a href="https://stackoverflow.com/questions/13716658/how-to-delete-all-commit-history-in-github" target="_blank">stackoverflow.com</a></p>
</div><!-- /.entry-content -->
</article>
</section>
<footer class="body" id="extras">
<div class="menu">
<h2>Menú</h2>
<nav>
<ul>
<li>
<strong><a href="/">INICIO</a></strong>
</li>
<li><a href="/p/about">About</a></li>
<li><a href="/mapa">Mapa</a></li>
<li><a href="https://github.com/s-nt-s/s-nt-s.github.io/tree/main" target="_blank">Ver Github</a></li>
<li><a href="https://github.com/s-nt-s/s-nt-s.github.io/tree/main/themes/notmyidea-custom/templates/article.html" target="_blank">Ver Template</a></li>
<li><a href="https://github.com/s-nt-s/s-nt-s.github.io/tree/main/content/posts/2020-09-04_reiniciar_git.md" target="_blank">Ver Markdown</a></li>
</ul>
<ul>
<li><a href="https://validator.w3.org/check?charset=(detect+automatically)&amp;doctype=Inline&amp;group=1&amp;uri=https://s-nt-s.github.io/reiniciar_git" target="_blank">Validar HTML</a></li>
</ul>
</nav>
</div><!-- /.menu -->
<div class="social">
<h2>Social</h2>
<ul>
<li><a href="/feeds/all.atom.xml" rel="alternate" type="application/atom+xml">atom feed</a></li>
<li><a href="https://github.com/s-nt-s/" target="_blank">@s-nt-s</a></li>
<li><a href="xmpp:git@suchat.org">git@suchat.org</a></li>
</ul>
</div><!-- /.social -->
<div class="license">
<p><a class="logo" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es" rel="license" target="_blank"><img alt="Licencia Creative Commons" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/></a> Esta obra está bajo una <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es" rel="license" target="_blank">Licencia Creative Commons Atribución-NoComercial-CompartirIgual 4.0 Internacional</a>.</p>
</div>
</footer><!-- /#extras -->
</body>
</html>